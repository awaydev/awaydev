warning: crappy code, and i'm not ashamed of it.
